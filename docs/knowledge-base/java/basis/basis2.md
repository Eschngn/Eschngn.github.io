---
title: åŸºç¡€çŸ¥è¯†2
sticky: true
category:
  - Java
tag:
  - JavaåŸºç¡€
---

## é¢å‘å¯¹è±¡

é¢å‘è¿‡ç¨‹ç¼–ç¨‹ï¼ˆProcedural-Oriented Programmingï¼ŒPOPï¼‰å’Œé¢å‘å¯¹è±¡ç¼–ç¨‹ï¼ˆObject-Oriented Programmingï¼ŒOOPï¼‰æ˜¯ä¸¤ç§å¸¸è§çš„ç¼–ç¨‹èŒƒå¼ï¼Œä¸¤è€…å¯¹æ¯”å¦‚ä¸‹ï¼š

| æ¯”è¾ƒé¡¹         | é¢å‘è¿‡ç¨‹ï¼ˆPOPï¼‰      | é¢å‘å¯¹è±¡ï¼ˆOOPï¼‰          |
| ----------- | -------------- | ------------------ |
| **æ ¸å¿ƒæ€æƒ³**    | ä»¥è¿‡ç¨‹ï¼ˆå‡½æ•°ï¼‰ä¸ºä¸­å¿ƒ     | ä»¥å¯¹è±¡ï¼ˆç±»ï¼‰ä¸ºä¸­å¿ƒ          |
| **ç»„ç»‡æ–¹å¼**    | ç¨‹åº = å‡½æ•° + æ•°æ®   | ç¨‹åº = å¯¹è±¡ï¼ˆå±æ€§ + æ–¹æ³•ï¼‰   |
| **å…³æ³¨ç‚¹**     | å…³æ³¨æµç¨‹å’Œæ­¥éª¤        | å…³æ³¨æ•°æ®å’Œè¡Œä¸º            |
| **æ•°æ®è®¿é—®**    | æ•°æ®æ˜¯å…¬å¼€çš„ï¼Œå‡½æ•°ç›´æ¥æ“ä½œ  | æ•°æ®å°è£…åœ¨å¯¹è±¡ä¸­ï¼Œé€šè¿‡æ–¹æ³•è®¿é—®    |
| **æ‰©å±•æ€§å’Œç»´æŠ¤æ€§** | ç»“æ„ç´§å¯†ï¼Œä¿®æ”¹éš¾åº¦å¤§     | æ¨¡å—åŒ–å¼ºï¼Œæ˜“äºæ‰©å±•ä¸ç»´æŠ¤       |
| **é‡ç”¨æ€§**     | é€šè¿‡å‡½æ•°å¤ç”¨         | é€šè¿‡ç±»ç»§æ‰¿ã€æ¥å£ã€å¤šæ€å¤ç”¨      |
| **é€‚ç”¨åœºæ™¯**    | å°ç¨‹åºã€ç®—æ³•æµç¨‹æ¸…æ™°çš„ç³»ç»Ÿ  | ä¸­å¤§å‹ç³»ç»Ÿã€å¤æ‚ä¸šåŠ¡é€»è¾‘å»ºæ¨¡     |
| **ä»£è¡¨è¯­è¨€**    | Cã€æ±‡ç¼–ã€æ—©æœŸ Pascal | Javaã€C++ã€Pythonã€C# |

OOP çš„ä¸‰å¤§ç‰¹å¾

- å°è£…ï¼šæŠŠæ•°æ®å’Œæ“ä½œå°è£…åœ¨å¯¹è±¡ä¸­ï¼Œä¸å…è®¸å¤–éƒ¨å¯¹è±¡ç›´æ¥è®¿é—®å¯¹è±¡å†…éƒ¨çš„ä¿¡æ¯ï¼Œä½†å¯¹å¤–æš´éœ²æ¥å£ï¼Œæä¾›ä¸€äº›å¯ä»¥è¢«å¤–ç•Œè®¿é—®çš„æ–¹æ³•æ¥æ“ä½œå±æ€§ã€‚

- ç»§æ‰¿ï¼šä½¿ç”¨å·²å­˜åœ¨çš„ç±»çš„å®šä¹‰ä½œä¸ºåŸºç¡€å»ºç«‹æ–°ç±»çš„æŠ€æœ¯ï¼Œæ–°ç±»çš„å®šä¹‰å¯ä»¥å¢åŠ æ–°çš„æ•°æ®æˆ–æ–°çš„åŠŸèƒ½ï¼Œä¹Ÿå¯ä»¥ç”¨çˆ¶ç±»çš„åŠŸèƒ½ï¼Œä½†ä¸èƒ½é€‰æ‹©æ€§åœ°ç»§æ‰¿çˆ¶ç±»ã€‚

  âš ï¸å…³äºç»§æ‰¿ï¼Œæ³¨æ„ä»¥ä¸‹å‡ ç‚¹ï¼š

  1. å­ç±»æ‹¥æœ‰çˆ¶ç±»å¯¹è±¡æ‰€æœ‰çš„å±æ€§å’Œæ–¹æ³•ï¼ˆåŒ…æ‹¬ç§æœ‰å±æ€§å’Œç§æœ‰æ–¹æ³•ï¼‰ï¼Œä½†æ˜¯çˆ¶ç±»ä¸­çš„ç§æœ‰å±æ€§å’Œæ–¹æ³•å­ç±»æ˜¯æ— æ³•è®¿é—®ï¼Œ**åªæ˜¯æ‹¥æœ‰**ã€‚
  2. å­ç±»å¯ä»¥æ‹¥æœ‰è‡ªå·±å±æ€§å’Œæ–¹æ³•ï¼Œå³å­ç±»å¯ä»¥å¯¹çˆ¶ç±»è¿›è¡Œæ‰©å±•ã€‚
  3. å­ç±»å¯ä»¥ç”¨è‡ªå·±çš„æ–¹å¼å®ç°çˆ¶ç±»çš„æ–¹æ³•ã€‚

- å¤šæ€ï¼šä¸€ä¸ªå¯¹è±¡å…·æœ‰å¤šç§çš„çŠ¶æ€ï¼Œå…·ä½“çš„è¡¨ç°ä¸ºçˆ¶ç±»çš„å¼•ç”¨æŒ‡å‘å­ç±»å¯¹è±¡çš„å®ä¾‹ï¼ŒåŠ¨æ€ç»‘å®šè°ƒç”¨æ–¹æ³•ã€‚

  ```java
  Animal animal = new Dog(); // Animal æ˜¯çˆ¶ç±»ï¼ŒDog æ˜¯å®ƒçš„å­ç±»
  ```

  âš ï¸å…³äºå¤šæ€ï¼Œæ³¨æ„ä»¥ä¸‹å‡ ç‚¹ï¼š

  1. å¯¹è±¡ç±»å‹å’Œå¼•ç”¨ç±»å‹ä¹‹é—´å…·æœ‰ç»§æ‰¿ï¼ˆç±»ï¼‰/å®ç°ï¼ˆæ¥å£ï¼‰çš„å…³ç³»ï¼›
  2. å¼•ç”¨ç±»å‹å˜é‡å‘å‡ºçš„æ–¹æ³•è°ƒç”¨çš„åˆ°åº•æ˜¯å“ªä¸ªç±»ä¸­çš„æ–¹æ³•ï¼Œå¿…é¡»åœ¨ç¨‹åºè¿è¡ŒæœŸé—´æ‰èƒ½ç¡®å®šï¼›
  3. å¤šæ€ä¸èƒ½è°ƒç”¨â€œåªåœ¨å­ç±»å­˜åœ¨ä½†åœ¨çˆ¶ç±»ä¸å­˜åœ¨â€çš„æ–¹æ³•ï¼›
  4. å¦‚æœå­ç±»é‡å†™äº†çˆ¶ç±»çš„æ–¹æ³•ï¼ŒçœŸæ­£æ‰§è¡Œçš„æ˜¯å­ç±»é‡å†™çš„æ–¹æ³•ï¼Œå¦‚æœå­ç±»æ²¡æœ‰é‡å†™çˆ¶ç±»çš„æ–¹æ³•ï¼Œæ‰§è¡Œçš„æ˜¯çˆ¶ç±»çš„æ–¹æ³•ã€‚

## æ¥å£ä¸æŠ½è±¡ç±»

### æŠ½è±¡ç±»

æŠ½è±¡ç±»ï¼ˆ`abstract class`ï¼‰ æ˜¯ä¸€ç§ä¸èƒ½è¢«å®ä¾‹åŒ–çš„ç±»ï¼Œç”¨æ¥è¢«å­ç±»ç»§æ‰¿å¹¶æ‰©å±•ï¼Œå…¶ä¸»è¦ä½œç”¨æ˜¯ä¸ºä¸€ç»„å­ç±»æä¾›å…±åŒçš„å±æ€§ã€è¡Œä¸ºæˆ–æ¥å£å®šä¹‰ã€‚å­ç±»ç»§æ‰¿æŠ½è±¡ç±»æ—¶ï¼Œå­ç±»å¿…é¡»å®ç°çˆ¶ç±»ä¸­å®šä¹‰çš„æŠ½è±¡æ–¹æ³•ã€‚

å¦‚æœä¸€ä¸ªæŠ½è±¡ç±» Aï¼Œç»§æ‰¿ä¸€ä¸ªæŠ½è±¡ç±» Bï¼Œæ­¤æ—¶ä¸éœ€è¦é‡å†™ B ä¸­çš„æŠ½è±¡æ–¹æ³•ï¼Œä½†å½“ A è¢«ç»§æ‰¿æ—¶ï¼ŒA çš„å­ç±»è¿˜æ˜¯è¦é‡å†™ B ä¸­çš„æŠ½è±¡æ–¹æ³•ã€‚

```java
abstract class ç±»å {
    // æˆå‘˜å˜é‡
    // æ„é€ æ–¹æ³•ï¼ˆå¯æœ‰ï¼‰
    // æ™®é€šæ–¹æ³•ï¼ˆå¯å®ç°ï¼‰
    // æŠ½è±¡æ–¹æ³•ï¼ˆæ— æ–¹æ³•ä½“ï¼Œè‡³å°‘æœ‰ä¸€ä¸ªï¼‰
}
```

### æ¥å£

æ¥å£é€šè¿‡ interface å…³é”®å­—æ¥å®šä¹‰ï¼Œå®ƒå¯ä»¥åŒ…å«ä¸€äº›å¸¸é‡å’Œæ–¹æ³•ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š

```java
public interface BasketballPlayer {
    // å¸¸é‡
    String NAME = "Shawn";

    // æŠ½è±¡æ–¹æ³•
    String getName();

    // é™æ€æ–¹æ³•
    static boolean isTrue(String name) {
        return name.equals(NAME);
    }

    // é»˜è®¤æ–¹æ³•
    default void printBasketball(){
        System.out.println("ç¯®çƒ");
    }

}
```

åç¼–è¯‘è¿™æ®µä»£ç çš„å­—èŠ‚ç åï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š

```java
public interface BasketballPlayer {
  public static final String NAME;
  public abstract String getName();
  public static boolean isTrue(String);
  public void printBasketball();
}
```

å¯ä»¥å‘ç°ä»¥ä¸‹å‡ ç‚¹ï¼š

1. æ²¡æœ‰ `private`ã€`default` æˆ–è€… `static` ä¿®é¥°çš„æ–¹æ³•æ˜¯éšå¼æŠ½è±¡çš„ï¼Œä¼šè‡ªåŠ¨åŠ ä¸Š `public abstract` ä¿®é¥°ç¬¦ï¼Œæ­£å¦‚ä¸Šä¾‹ä¸­çš„ `getName` æ–¹æ³•ï¼Œå…¶å®æ˜¯ä¸€ä¸ªæŠ½è±¡æ–¹æ³• â€”â€” è¿™ä¾¿æ˜¯å®šä¹‰æ¥å£çš„æ„ä¹‰ã€‚

2. æ¥å£ä¸­å®šä¹‰çš„å˜é‡é»˜è®¤æ˜¯ç”¨ `public static final` ä¿®é¥°çš„ã€‚

   Java å®˜æ–¹æ–‡æ¡£ä¸Šæœ‰è¿™æ ·çš„å£°æ˜ï¼š

   > Every field declaration in the body of an interface is implicitly public, static, and final.

   å› æ­¤ï¼Œæ¥å£å¯ä»¥ç”¨æ¥ä½œä¸ºå¸¸é‡ç±»ä½¿ç”¨ï¼Œè¿˜èƒ½çœç•¥æ‰ `public static final`ã€‚

3. ä» **Java 8** å¼€å§‹ï¼Œæ¥å£ä¸­å…è®¸å¼•å…¥é™æ€æ–¹æ³•ï¼Œæ¯”å¦‚ä¸Šä¾‹ä¸­çš„ `isTrue()` æ–¹æ³•ï¼Œè¿™å…è®¸æˆ‘ä»¬å¯ä»¥åœ¨æ¥å£ä¸­æä¾›ä¸€äº›ä¸æ¥å£æœ¬èº«ç´§å¯†å…³è”çš„å®ç”¨çš„è¾…åŠ©æ–¹æ³•ï¼Œè€Œä¸å¿…åˆ›å»ºä¸€ä¸ªå•ç‹¬çš„å·¥å…·ç±»æ¥å­˜æ”¾è¿™äº›æ–¹æ³•ï¼Œä»è€Œæé«˜æé«˜å†…èšæ€§ã€‚

   å› æ­¤ï¼Œæ¥å£ä¸­çš„ `static` æ–¹æ³•å¿…é¡»è¦æœ‰æ–¹æ³•ä½“ï¼š

   ![æ¥å£ä¸­çš„ `static` æ–¹æ³•è¦æœ‰æ–¹æ³•ä½“](https://chengliuxiang.oss-cn-hangzhou.aliyuncs.com/blog/interface-static-method-should-have-body.png)

4. ä» **Java 8** å¼€å§‹ï¼Œæ¥å£ä¸­å…è®¸å®šä¹‰ `default` æ–¹æ³•ï¼Œæ¯”å¦‚ä¸Šä¾‹ä¸­çš„ `printBasketball()` æ–¹æ³•ã€‚

   ä¸ºä»€ä¹ˆéœ€è¦ `default` æ–¹æ³•ï¼Ÿ

   > åœ¨ Java 8 ä¹‹å‰ï¼Œå¦‚æœæˆ‘ä»¬ä¿®æ”¹äº†ä¸€ä¸ªæ¥å£ï¼ˆä¾‹å¦‚ï¼Œæ·»åŠ äº†ä¸€ä¸ªæ–°æ–¹æ³•ï¼‰ï¼Œæ‰€æœ‰å®ç°è¯¥æ¥å£çš„ç±»éƒ½å¿…é¡»åŒæ—¶ä¿®æ”¹ï¼Œä»¥å®ç°è¿™ä¸ªæ–°æ–¹æ³•ã€‚è¿™åœ¨å¤§å‹é¡¹ç›®ä¸­ï¼Œå°¤å…¶æ˜¯å½“æ¥å£è¢«è®¸å¤šä¸åŒçš„æ¨¡å—æˆ–ç¬¬ä¸‰æ–¹åº“å®ç°æ—¶ï¼Œä¼šæˆä¸ºä¸€ä¸ªå·¨å¤§çš„é—®é¢˜ï¼Œå› ä¸ºè¿™å°†å¯¼è‡´å¤§é‡çš„ä»£ç ä¿®æ”¹å’Œå…¼å®¹æ€§é—®é¢˜ã€‚
   >
   > `default` æ–¹æ³•çš„å‡ºç°è§£å†³äº†è¿™ä¸ªé—®é¢˜ã€‚å®ƒå…è®¸æˆ‘ä»¬åœ¨æ¥å£ä¸­å®šä¹‰å¸¦æœ‰é»˜è®¤å®ç°çš„æ–¹æ³•ã€‚è¿™æ„å‘³ç€ï¼Œå¦‚æœä¸€ä¸ªå®ç°ç±»æ²¡æœ‰æä¾›è‡ªå·±çš„å®ç°ï¼Œå®ƒå°†è‡ªåŠ¨ç»§æ‰¿æ¥å£ä¸­æä¾›çš„é»˜è®¤å®ç°ï¼Œè€Œä¸éœ€è¦ä¿®æ”¹ä»£ç ã€‚è¿™ä½¿å¾—æ¥å£çš„æ¼”è¿›å˜å¾—æ›´åŠ å¹³æ»‘å’Œå®‰å…¨ã€‚

   å› æ­¤ï¼Œæ¥å£ä¸­çš„ `default` æ–¹æ³•ä¹Ÿå¿…é¡»è¦æœ‰æ–¹æ³•ä½“ï¼š

   ![æ¥å£ä¸­çš„ `default` æ–¹æ³•è¦æœ‰æ–¹æ³•ä½“](https://chengliuxiang.oss-cn-hangzhou.aliyuncs.com/blog/interface-%20default-method-should-have-body.png)

5. ä» **Java 9** å¼€å§‹ï¼Œæ¥å£ä¸­å…è®¸å®šä¹‰ `private` æ–¹æ³•æ¥å°è£…ä¸€äº›é‡å¤çš„é€»è¾‘ï¼Œä¾›é»˜è®¤æ–¹æ³•å’Œé™æ€æ–¹æ³•è°ƒç”¨ï¼Œæé«˜ä»£ç çš„å¯è¯»æ€§å’Œå¯ç»´æŠ¤æ€§ã€‚

6. æ¥å£ä¸å¯ä»¥è¢«å®ä¾‹åŒ–ï¼Œä¹Ÿå°±æ˜¯è¯´æ¥å£ä¸èƒ½æœ‰é™æ€ä»£ç å—å’Œæ„é€ æ–¹æ³•ã€‚

### ä¸¤è€…çš„åŒºåˆ«

1. è¯­æ³•å±‚é¢ï¼š

   - ç»§æ‰¿å’Œå®ç°ï¼šä¸€ä¸ªç±»åªèƒ½ç»§æ‰¿ä¸€ä¸ªç±»ï¼ˆåŒ…æ‹¬æŠ½è±¡ç±»ï¼‰ï¼Œå› ä¸º Java ä¸æ”¯æŒå¤šç»§æ‰¿ã€‚ä½†ä¸€ä¸ªç±»å¯ä»¥å®ç°å¤šä¸ªæ¥å£ï¼Œä¸€ä¸ªæ¥å£ä¹Ÿå¯ä»¥ç»§æ‰¿å¤šä¸ªå…¶ä»–æ¥å£ã€‚
   - æˆå‘˜å˜é‡ï¼šæ¥å£ä¸­çš„æˆå‘˜å˜é‡åªèƒ½æ˜¯ `public static final` ç±»å‹çš„ï¼Œä¸èƒ½è¢«ä¿®æ”¹ä¸”å¿…é¡»æœ‰åˆå§‹å€¼ã€‚æŠ½è±¡ç±»çš„æˆå‘˜å˜é‡å¯ä»¥æœ‰ä»»ä½•ä¿®é¥°ç¬¦ï¼ˆ`private`, `protected`, `public`ï¼‰ï¼Œå¯ä»¥åœ¨å­ç±»ä¸­è¢«é‡æ–°å®šä¹‰æˆ–èµ‹å€¼ã€‚
   - æ–¹æ³•ï¼šJava 8 ä¹‹å‰ï¼Œæ¥å£ä¸­çš„æ–¹æ³•é»˜è®¤æ˜¯ `public abstract` ï¼Œä¹Ÿå°±æ˜¯åªèƒ½æœ‰æ–¹æ³•å£°æ˜ã€‚è‡ª Java 8 èµ·ï¼Œå¯ä»¥åœ¨æ¥å£ä¸­å®šä¹‰ `default`ï¼ˆé»˜è®¤ï¼‰ æ–¹æ³•å’Œ `static` ï¼ˆé™æ€ï¼‰æ–¹æ³•ã€‚ è‡ª Java 9 èµ·ï¼Œæ¥å£å¯ä»¥åŒ…å« `private` æ–¹æ³•ã€‚æŠ½è±¡ç±»å¯ä»¥åŒ…å«æŠ½è±¡æ–¹æ³•å’ŒéæŠ½è±¡æ–¹æ³•ã€‚æŠ½è±¡æ–¹æ³•æ²¡æœ‰æ–¹æ³•ä½“ï¼Œå¿…é¡»åœ¨å­ç±»ä¸­å®ç°ã€‚éæŠ½è±¡æ–¹æ³•æœ‰å…·ä½“å®ç°ï¼Œå¯ä»¥ç›´æ¥åœ¨æŠ½è±¡ç±»ä¸­ä½¿ç”¨æˆ–åœ¨å­ç±»ä¸­é‡å†™ã€‚

2. è®¾è®¡å±‚é¢ï¼š

   - æ¥å£çš„æ ¸å¿ƒè®¾è®¡ç†å¿µæ˜¯**å¥‘çº¦**æˆ–è€…**èƒ½åŠ›**ï¼Œå®ƒå®šä¹‰äº†ä¸€ç»„å¯¹è±¡å¯ä»¥æ‹¥æœ‰çš„å…¬å…±è¡Œä¸ºçš„è§„èŒƒï¼ˆ`What`ï¼‰ï¼Œè€Œä¸å…³å¿ƒè¿™äº›è¡Œä¸ºæ˜¯å¦‚ä½•å®ç°çš„ã€‚æ¥å£çš„å…³æ³¨ç‚¹æ˜¯è¡Œä¸ºçš„æŠ½è±¡ï¼Œå®ƒæè¿°äº†ä¸€ä¸ªç±»èƒ½åšä»€ä¹ˆï¼Œé€šå¸¸ç”¨äºæ ‡è¯†ä¸€ç§  `has-a` çš„å…³ç³»ã€‚

   - æŠ½è±¡ç±»çš„æ ¸å¿ƒè®¾è®¡ç†å¿µæ˜¯**æ¨¡ç‰ˆ**æˆ–è€…**éª¨æ¶**ï¼Œå®ƒæä¾›äº†ä¸€ä¸ªéƒ¨åˆ†å®ç°çš„åŸºç±»ï¼ˆå¯èƒ½åŒ…å«å…·ä½“æ–¹æ³•å’ŒæŠ½è±¡æ–¹æ³•ï¼‰ï¼Œæ—¨åœ¨è¢«å­ç±»ç»§æ‰¿å’Œæ‰©å±•ï¼ˆ`How + What`ï¼‰ã€‚æŠ½è±¡ç±»é€šå¸¸ç”¨äºæ ‡è¯†ä¸€ç§ `is-a` çš„å…³ç³»ï¼Œå³å­ç±»æ˜¯æŠ½è±¡ç±»çš„ä¸€ç§ç‰¹æ®Šç±»å‹ã€‚å®ƒä¸ä»…å®šä¹‰äº† â€œæˆ‘èƒ½åšä»€ä¹ˆâ€ï¼Œè¿˜å¯èƒ½æä¾›äº† â€œæˆ‘å¦‚ä½•åšä¸€éƒ¨åˆ†â€ã€‚

   - ä¸¾ä¸ªæ —å­ğŸŒ°ï¼š

     æ¯”å¦‚ä¸€ä¸ªç‰©æµæ´¾é€ç³»ç»Ÿä¸­ï¼Œæœ‰å¤šç§ç±»å‹çš„è¿è¾“å·¥å…·ï¼Œæ¯”å¦‚ï¼šå¡è½¦ã€è´§è½®ã€é£æœºã€æ— äººæœºç­‰ç­‰ã€‚

     æˆ‘ä»¬å¯ä»¥ç”¨æ¥å£å®šä¹‰ â€œèƒ½åŠ›â€ â€”â€” æ¯”å¦‚ â€œå¯ä»¥é£â€ï¼ˆ`Flyable`ï¼‰ã€â€œå¯ä»¥è£…è´§â€ï¼ˆ`Loadable`ï¼‰ï¼Œæˆ‘ä»¬ä¸ç”¨å…³å¿ƒå¯¹è±¡æ˜¯é£æœºè¿˜æ˜¯æ— äººæœºï¼Œåªè¦èƒ½é£ï¼Œå°±å®ç° `Flyable`ï¼›åªè¦èƒ½è£…è´§ï¼Œå°±å®ç° `Loadable`ã€‚

     ```java
     public interface Flyable {
         void fly();
     }
     
     public interface Loadable {
         void loadCargo(double weight);
     }
     ```

     æˆ‘ä»¬å¯ä»¥ç”¨æŠ½è±¡ç±»å®šä¹‰ â€œæ¨¡ç‰ˆâ€ â€”â€” æ¯”å¦‚ â€œè¿è¾“å·¥å…·â€ï¼ˆ`TransportVehicle`ï¼‰ï¼Œè¿™ä¸ªæŠ½è±¡ç±»æè¿°çš„æ˜¯ â€œæ‰€æœ‰è¿è¾“å·¥å…·çš„é€šç”¨éƒ¨åˆ†â€ï¼Œæ¯”å¦‚éƒ½æœ‰ä¸€ä¸ªå¸æœºã€éƒ½éœ€è¦æ‰§è¡Œé€è´§æ“ä½œï¼Œå±äº â€œæ˜¯ä¸€ç§è¿è¾“å·¥å…·â€ çš„ç±»å‹å…³ç³»ï¼Œæ˜¯ä¸€ä¸ªç»§æ‰¿ä½“ç³»ã€‚

     ```java
     public abstract class TransportVehicle {
         protected String id;
         protected String driver;
     
         public void assignDriver(String driverName) {
             this.driver = driverName;
         }
     
         public abstract void deliver(String destination);
     }
     ```

     ğŸš›å¡è½¦ Truckï¼š

     ```java
     public class Truck extends TransportVehicle implements Loadable {
         @Override
         public void deliver(String destination) {
             System.out.println("Truck delivering to " + destination);
         }
     
         @Override
         public void loadCargo(double weight) {
             System.out.println("Truck loaded with " + weight + "kg");
         }
     }
     ```

     ğŸšæ— äººæœºï¼š

     ```java
     public class Drone extends TransportVehicle implements Flyable, Loadable {
         @Override
         public void deliver(String destination) {
             System.out.println("Drone flying to " + destination);
         }
     
         @Override
         public void fly() {
             System.out.println("Drone taking off...");
         }
     
         @Override
         public void loadCargo(double weight) {
             System.out.println("Drone loaded with " + weight + "kg");
         }
     }
     ```
## æ·±æ‹·è´å’Œæµ…æ‹·è´

### æµ…æ‹·è´

æµ…æ‹·è´ä¼šåœ¨å †ä¸Šåˆ›å»ºä¸€ä¸ªæ–°çš„å¯¹è±¡ï¼ˆåŒºåˆ«äºå¼•ç”¨æ‹·è´ï¼šä¸¤ä¸ªä¸åŒçš„å¼•ç”¨æŒ‡å‘åŒä¸€ä¸ªå¯¹è±¡ï¼‰ï¼Œè¿™ä¸ªæ–°å¯¹è±¡é‡Œçš„åŸºæœ¬æ•°æ®ç±»å‹å’Œå¯¹åº”çš„åŒ…è£…æ•°æ®ç±»å‹ä»¥åŠä¸å¯å˜å¯¹è±¡ `String` æˆå‘˜æ˜¯åŸå¯¹è±¡å€¼çš„å‰¯æœ¬ï¼Œè€Œå¼•ç”¨ç±»å‹æˆå‘˜ï¼ˆæ¯”å¦‚å¯¹è±¡ã€æ•°ç»„ï¼‰ä»…ä»…æ˜¯å¤åˆ¶äº†å¼•ç”¨åœ°å€ï¼Œè¿™æ„å‘³ç€åŸå¯¹è±¡å’Œæ–°å¯¹è±¡ä¼šå…±äº«è¿™äº›å¼•ç”¨ç±»å‹æˆå‘˜æŒ‡å‘çš„å†…å­˜ç©ºé—´ï¼ˆæŒ‡å‘åŒä¸€ä¸ªå †å†…å®¹ä¸­çš„å¼•ç”¨ç±»å‹æˆå‘˜ï¼‰ã€‚

```java
class Subject {
    String name;

    public Subject(String name) {
        this.name = name;
    }
}

class Student implements Cloneable {
    String studentName; // ä¸å¯å˜å¯¹è±¡
    Subject subject;    // å¼•ç”¨ç±»å‹æˆå‘˜
    int age;            // åŸºæœ¬æ•°æ®ç±»å‹
    Integer height;     // åŒ…è£…æ•°æ®ç±»å‹

    public Student(String studentName, String subjectName, int age, Integer height) {
        this.studentName = studentName;
        this.subject = new Subject(subjectName);
        this.age = age;
        this.height = height;
    }

    @Override
    protected Object clone() throws CloneNotSupportedException {
        return super.clone(); // æ‰§è¡Œæµ…æ‹·è´
    }

    public void display() {
        System.out.println("å­¦ç”Ÿå§“å: " + studentName + ", ç§‘ç›®: " + subject.name + ", å¹´é¾„: " + age + ", èº«é«˜: " + height);
        System.out.println("Subject å¯¹è±¡å†…å­˜åœ°å€: " + subject.hashCode());
    }
}

public class ShallowCopyDemo {
    public static void main(String[] args) {
        try {
            Student originalStudent = new Student("å¼ ä¸‰", "æ•°å­¦", 18, 175);
            System.out.println("åŸå§‹å­¦ç”Ÿä¿¡æ¯:");
            originalStudent.display();

            Student clonedStudent = (Student) originalStudent.clone(); // æµ…æ‹·è´
            System.out.println("\næ‹·è´å­¦ç”Ÿä¿¡æ¯ (æµ…æ‹·è´å):");
            clonedStudent.display();

            // ä¿®æ”¹æ‹·è´å¯¹è±¡çš„å¼•ç”¨ç±»å‹æˆå‘˜
            clonedStudent.studentName = "æå››";  // ä¸å¯å˜ç±»å‹ä¿®æ”¹ï¼Œäº’ä¸å½±å“
            clonedStudent.subject.name = "ç‰©ç†"; // å¼•ç”¨ç±»å‹ä¿®æ”¹ï¼Œä¼šå½±å“åŸå¯¹è±¡
            clonedStudent.age = 21;             // åŸºæœ¬ç±»å‹ä¿®æ”¹ï¼Œäº’ä¸å½±å“
            clonedStudent.height = 180;         // åŒ…è£…ç±»å‹ä¿®æ”¹ï¼Œäº’ä¸å½±å“

            System.out.println("\nä¿®æ”¹æ‹·è´å¯¹è±¡å:");
            System.out.println("åŸå§‹å­¦ç”Ÿä¿¡æ¯:");
            originalStudent.display(); // æ³¨æ„ï¼šåŸå¯¹è±¡çš„ç§‘ç›®ä¹Ÿå˜æˆäº†â€œç‰©ç†â€
            System.out.println("æ‹·è´å­¦ç”Ÿä¿¡æ¯:");
            clonedStudent.display();

        } catch (CloneNotSupportedException e) {
            e.printStackTrace();
        }
    }
}
```

è¿è¡Œç»“æœï¼š

```tex
åŸå§‹å­¦ç”Ÿä¿¡æ¯:
å­¦ç”Ÿå§“å: å¼ ä¸‰, ç§‘ç›®: æ•°å­¦, å¹´é¾„: 18, èº«é«˜: 175
Subject å¯¹è±¡å†…å­˜åœ°å€: 356573597

æ‹·è´å­¦ç”Ÿä¿¡æ¯ (æµ…æ‹·è´å):
å­¦ç”Ÿå§“å: å¼ ä¸‰, ç§‘ç›®: æ•°å­¦, å¹´é¾„: 18, èº«é«˜: 175
Subject å¯¹è±¡å†…å­˜åœ°å€: 356573597

ä¿®æ”¹æ‹·è´å¯¹è±¡å:
åŸå§‹å­¦ç”Ÿä¿¡æ¯:
å­¦ç”Ÿå§“å: å¼ ä¸‰, ç§‘ç›®: ç‰©ç†, å¹´é¾„: 18, èº«é«˜: 175   <-- åŸå¯¹è±¡çš„ç§‘ç›®ä¹Ÿå˜æˆäº†â€œç‰©ç†â€
Subject å¯¹è±¡å†…å­˜åœ°å€: 356573597
æ‹·è´å­¦ç”Ÿä¿¡æ¯:
å­¦ç”Ÿå§“å: æå››, ç§‘ç›®: ç‰©ç†, å¹´é¾„: 21, èº«é«˜: 180
Subject å¯¹è±¡å†…å­˜åœ°å€: 356573597
```
å¯ä»¥çœ‹åˆ°ï¼Œ`originalStudent` å’Œ `clonedStudent` çš„ `subject` æˆå‘˜æŒ‡å‘äº†åŒä¸€ä¸ª `Subject` å¯¹è±¡ï¼Œæ‰€ä»¥ä¿®æ”¹å…¶ä¸­ä¸€ä¸ªä¼šå¯¼è‡´å¦ä¸€ä¸ªä¹Ÿå—å½±å“ï¼›è€Œ `studentName`ã€`age` å’Œ `height` åˆ™ç›¸äº’ç‹¬ç«‹ï¼Œäº’ä¸å½±å“ã€‚

![æµ…æ‹·è´ â€”â€” å¼•ç”¨çš„ `Subject` å¯¹è±¡å…±äº«](https://chengliuxiang.oss-cn-hangzhou.aliyuncs.com/blog/shallow-copy.png)

### æ·±æ‹·è´

æ·±æ‹·è´ä¸ä»…ä¼šå¤åˆ¶å¯¹è±¡æœ¬èº«ï¼Œè¿˜ä¼šé€’å½’åœ°å¤åˆ¶å…¶å†…éƒ¨æ‰€æœ‰å¼•ç”¨çš„å¯¹è±¡ã€‚è¿™æ„å‘³ç€åŸå¯¹è±¡å’Œæ–°å¯¹è±¡åœ¨å†…å­˜ä¸­æ˜¯å®Œå…¨ç‹¬ç«‹çš„ï¼Œæ²¡æœ‰ä»»ä½•å…±äº«çš„å¼•ç”¨ã€‚

å¸¸è§çš„æ·±æ‹·è´çš„å®ç°æ–¹å¼ï¼š

1. é€’å½’å®ç° `clone()`ï¼š åœ¨ `clone()` æ–¹æ³•ä¸­ï¼Œé™¤äº†è°ƒç”¨ `super.clone()` è¿›è¡Œæµ…æ‹·è´å¤–ï¼Œè¿˜è¦æ‰‹åŠ¨å¯¹å…¶æ‰€æœ‰å¼•ç”¨ç±»å‹æˆå‘˜è°ƒç”¨å®ƒä»¬çš„ `clone()` æ–¹æ³•ï¼Œç¡®ä¿å®ƒä»¬ä¹Ÿè¢«å®Œå…¨å¤åˆ¶ã€‚è¿™ç§æ–¹å¼è¦æ±‚æ‰€æœ‰æ¶‰åŠåˆ°æ‹·è´çš„ç±»éƒ½å®ç° `Cloneable` æ¥å£ã€‚

2. åºåˆ—åŒ–å’Œååºåˆ—åŒ–ï¼š å°†å¯¹è±¡å…ˆåºåˆ—åŒ–æˆå­—èŠ‚æµï¼Œå†ä»å­—èŠ‚æµååºåˆ—åŒ–å›æ¥ã€‚è¿™ç§æ–¹å¼ä¼šåˆ›å»ºå…¨æ–°çš„å¯¹è±¡å›¾ï¼Œæ˜¯å®ç°æ·±æ‹·è´çš„ä¸€ç§ç®€å•æœ‰æ•ˆçš„æ–¹æ³•ï¼Œä½†éœ€è¦ç±»å®ç° `Serializable` æ¥å£ï¼Œå¹¶ä¸”ä¼šæœ‰ä¸€å®šçš„æ€§èƒ½å¼€é”€ã€‚

3. æ„é€ å™¨æˆ–å·¥å‚æ–¹æ³•ï¼š æ‰‹åŠ¨ç¼–å†™ä»£ç ï¼Œåœ¨æ„é€ æ–°å¯¹è±¡æ—¶ï¼Œåˆ›å»ºæ‰€æœ‰å¼•ç”¨ç±»å‹æˆå‘˜çš„æ–°å®ä¾‹å¹¶æ‹·è´æ•°æ®ã€‚

ä¸‹é¢æ˜¯ä½¿ç”¨é€’å½’çš„æ–¹å¼å®ç°çš„æ·±æ‹·è´ï¼š

```java
class SubjectDeep implements Cloneable {
    String name;

    public SubjectDeep(String name) {
        this.name = name;
    }

    @Override
    protected Object clone() throws CloneNotSupportedException {
        return super.clone(); // SubjectDeep è‡ªèº«ä¹Ÿéœ€è¦æµ…æ‹·è´
    }
}

class StudentDeep implements Cloneable {
    String studentName;
    SubjectDeep subject; // å¼•ç”¨ç±»å‹æˆå‘˜
    int age;
    Integer height;

    public StudentDeep(String studentName, String subjectName, int age, Integer height) {
        this.studentName = studentName;
        this.subject = new SubjectDeep(subjectName);
        this.age = age;
        this.height = height;
    }

    // æ·±æ‹·è´å®ç°
    @Override
    protected Object clone() throws CloneNotSupportedException {
        StudentDeep clonedStudent = (StudentDeep) super.clone(); // é¦–å…ˆè¿›è¡Œæµ…æ‹·è´

        // å…³é”®æ­¥éª¤ï¼šæ‰‹åŠ¨å¯¹å¼•ç”¨ç±»å‹æˆå‘˜è¿›è¡Œæ·±æ‹·è´
        clonedStudent.subject = (SubjectDeep) subject.clone();
        return clonedStudent;
    }

    public void display() {
        System.out.println("å­¦ç”Ÿå§“å: " + studentName + ", ç§‘ç›®: " + subject.name + ", å¹´é¾„: " + age + ", èº«é«˜: " + height);
        System.out.println("SubjectDeep å¯¹è±¡å†…å­˜åœ°å€: " + subject.hashCode());
    }
}

public class DeepCopyDemo {
    public static void main(String[] args) {
        try {
            StudentDeep originalStudent = new StudentDeep("å¼ ä¸‰", "æ•°å­¦", 18, 175);
            System.out.println("åŸå§‹å­¦ç”Ÿä¿¡æ¯:");
            originalStudent.display();

            StudentDeep clonedStudent = (StudentDeep) originalStudent.clone(); // æ·±æ‹·è´
            System.out.println("\næ‹·è´å­¦ç”Ÿä¿¡æ¯ (æ·±æ‹·è´å):");
            clonedStudent.display();

            // ä¿®æ”¹æ‹·è´å¯¹è±¡çš„å¼•ç”¨ç±»å‹æˆå‘˜
            clonedStudent.studentName = "æå››";
            clonedStudent.subject.name = "ç‰©ç†";
            clonedStudent.age = 21;
            clonedStudent.height = 180;

            System.out.println("\nä¿®æ”¹æ‹·è´å¯¹è±¡å:");
            System.out.println("åŸå§‹å­¦ç”Ÿä¿¡æ¯:");
            originalStudent.display(); // æ³¨æ„ï¼šåŸå¯¹è±¡çš„ç§‘ç›®**æ²¡æœ‰**è¢«ä¿®æ”¹
            System.out.println("æ‹·è´å­¦ç”Ÿä¿¡æ¯:");
            clonedStudent.display();

        } catch (CloneNotSupportedException e) {
            e.printStackTrace();
        }
    }
}
```

è¿è¡Œç»“æœï¼š

```tex
åŸå§‹å­¦ç”Ÿä¿¡æ¯:
å­¦ç”Ÿå§“å: å¼ ä¸‰, ç§‘ç›®: æ•°å­¦, å¹´é¾„: 18, èº«é«˜: 175
SubjectDeep å¯¹è±¡å†…å­˜åœ°å€: 356573597

æ‹·è´å­¦ç”Ÿä¿¡æ¯ (æ·±æ‹·è´å):
å­¦ç”Ÿå§“å: å¼ ä¸‰, ç§‘ç›®: æ•°å­¦, å¹´é¾„: 18, èº«é«˜: 175
SubjectDeep å¯¹è±¡å†…å­˜åœ°å€: 1735600054   <-- åœ°å€ä¸åŒäº†

ä¿®æ”¹æ‹·è´å¯¹è±¡å:
åŸå§‹å­¦ç”Ÿä¿¡æ¯:
å­¦ç”Ÿå§“å: å¼ ä¸‰, ç§‘ç›®: æ•°å­¦, å¹´é¾„: 18, èº«é«˜: 175   <-- åŸå§‹å¯¹è±¡çš„ç§‘ç›®æœªè¢«ä¿®æ”¹
SubjectDeep å¯¹è±¡å†…å­˜åœ°å€: 356573597
æ‹·è´å­¦ç”Ÿä¿¡æ¯:
å­¦ç”Ÿå§“å: æå››, ç§‘ç›®: ç‰©ç†, å¹´é¾„: 21, èº«é«˜: 180
SubjectDeep å¯¹è±¡å†…å­˜åœ°å€: 1735600054
```

ç°åœ¨ï¼Œä¿®æ”¹ `clonedStudent` çš„ `subject` ä¸ä¼šå½±å“ `originalStudent` çš„ `subject`ï¼Œå› ä¸º `clonedStudent.subject` æ˜¯ä¸€ä¸ªå…¨æ–°çš„ `SubjectDeep` å¯¹è±¡ï¼Œåœ¨å†…å­˜ä¸­ä¸åŸå¯¹è±¡æ˜¯å®Œå…¨ç‹¬ç«‹çš„ã€‚

![æ·±æ‹·è´ â€”â€” å¼•ç”¨çš„ `Subject` å¯¹è±¡ä¸å…±äº«](https://chengliuxiang.oss-cn-hangzhou.aliyuncs.com/blog/deep-copy.png)

### ä¸¤è€…å¯¹æ¯”

| ç‰¹æ€§       | æµ…æ‹·è´ï¼ˆShallow Copyï¼‰                                       | æ·±æ‹·è´ï¼ˆDeep Copyï¼‰                                          |
| ---------- | ------------------------------------------------------------ | ------------------------------------------------------------ |
| æ‹·è´æ·±åº¦   | åªæ‹·è´å¯¹è±¡æœ¬èº«ï¼Œä¸æ‹·è´å…¶å†…éƒ¨å¼•ç”¨çš„å¯¹è±¡ã€‚                     | é€’å½’åœ°æ‹·è´å¯¹è±¡æœ¬èº«åŠå…¶æ‰€æœ‰å†…éƒ¨å¼•ç”¨çš„å¯¹è±¡ã€‚                   |
| ç‹¬ç«‹æ€§     | åŸå§‹å¯¹è±¡å’Œæ‹·è´å¯¹è±¡å…±äº«å¼•ç”¨ç±»å‹æˆå‘˜ã€‚                         | åŸå§‹å¯¹è±¡å’Œæ‹·è´å¯¹è±¡å®Œå…¨ç‹¬ç«‹ã€‚                                 |
| ä¿®æ”¹å½±å“   | ä¿®æ”¹æ‹·è´å¯¹è±¡çš„å¼•ç”¨ç±»å‹æˆå‘˜ï¼Œä¼šå½±å“åŸå§‹å¯¹è±¡ã€‚                 | ä¿®æ”¹æ‹·è´å¯¹è±¡çš„ä»»ä½•æˆå‘˜ï¼Œä¸å½±å“åŸå§‹å¯¹è±¡ã€‚                     |
| é€‚ç”¨åœºæ™¯   | 1. å¯¹è±¡åªåŒ…å«åŸºæœ¬æ•°æ®ç±»å‹åŠå…¶å¯¹åº”åŒ…è£…ç±»å‹ã€‚  2. å¯¹è±¡åŒ…å«ä¸å¯å˜å¯¹è±¡ï¼ˆå¦‚ Stringï¼‰ã€‚ 3. ä½ å¯ä»¥æ¥å—å…±äº«å¼•ç”¨ç±»å‹æˆå‘˜çš„é£é™©ï¼Œæˆ–ä¸éœ€è¦ä¿®æ”¹å®ƒä»¬ã€‚ | 1. å¯¹è±¡åŒ…å«å¯å˜çš„å¼•ç”¨ç±»å‹æˆå‘˜ã€‚  2. éœ€è¦ç¡®ä¿åŸå¯¹è±¡å’Œæ‹·è´å¯¹è±¡å®Œå…¨éš”ç¦»ï¼Œä¿®æ”¹äº’ä¸å½±éŸ¿ã€‚ |
| å®ç°å¤æ‚æ€§ | ç®€å•ï¼Œç›´æ¥è°ƒç”¨ super.clone()ã€‚                               | å¤æ‚ï¼Œéœ€è¦é€’å½’æ‹·è´æ‰€æœ‰å±‚çº§çš„å¼•ç”¨å¯¹è±¡ã€‚                       |


